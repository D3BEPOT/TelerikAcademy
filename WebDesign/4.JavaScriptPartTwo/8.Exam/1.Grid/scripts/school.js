// Generated by CoffeeScript 1.4.0
(function() {
  'use strict';

  var Course, School, Student, schoolRepository, _ref;

  if ((_ref = this.studentNS) == null) {
    this.studentNS = {};
  }

  Student = (function() {

    function Student(firstName, lastName, grade) {
      this.firstName = firstName;
      this.lastName = lastName;
      this.grade = grade;
      this.marks = {};
    }

    Student.prototype.addMark = function(course, mark) {
      return this.marks[course.title] = mark;
    };

    Student.prototype.getMark = function(course) {
      return this.marks[course.title];
    };

    Student.deserialize = function(studentData) {
      var student;
      student = new Student(studentData.firstName, studentData.lastName, parseInt(studentData.grade, 10));
      student.marks = studentData.marks;
      return student;
    };

    return Student;

  })();

  Course = (function() {

    function Course(title, startDate) {
      this.title = title;
      this.startDate = startDate;
      this.numberOfStudents = 0;
      this.students = [];
    }

    Course.prototype.addStudents = function(students) {
      var student, _i, _len;
      this.numberOfStudents += students.length;
      for (_i = 0, _len = students.length; _i < _len; _i++) {
        student = students[_i];
        this.students.push(student);
      }
      return this;
    };

    Course.deserialize = function(courseData) {
      var course;
      course = new Course(courseData.title, new Date(courseData.startDate));
      return course.addStudents(courseData.students.map(function(student) {
        return Student.deserialize(student);
      }));
    };

    return Course;

  })();

  School = (function() {

    function School(name, location, specialty) {
      this.name = name;
      this.location = location;
      this.specialty = specialty;
      this.numberOfCourses = 0;
      this.courses = [];
    }

    School.prototype.addCourse = function(courses) {
      var course, _i, _len;
      this.numberOfCourses += courses.length;
      for (_i = 0, _len = courses.length; _i < _len; _i++) {
        course = courses[_i];
        this.courses.push(course);
      }
      return this;
    };

    School.deserialize = function(schoolData) {
      var school;
      school = new School(schoolData.name, schoolData.location, schoolData.specialty);
      return school.addCourse(schoolData.courses.map(function(course) {
        return Course.deserialize(course);
      }));
    };

    return School;

  })();

  schoolRepository = (function() {
    return {
      save: function(id, schoolsData) {
        return window.localStorage[id] = JSON.stringify(schoolsData);
      },
      load: function(id) {
        return JSON.parse(window.localStorage[id]).map(function(schoolData) {
          return School.deserialize(schoolData);
        });
      }
    };
  })();

  this.schoolNS = {
    Student: Student,
    Course: Course,
    School: School,
    schoolRepository: schoolRepository
  };

}).call(this);
